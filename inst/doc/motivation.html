<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Daniel Antal" />


<title>Motivation: Make Tidy Datasets Easier to Release Exchange and Reuse</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Motivation: Make Tidy Datasets Easier to
Release Exchange and Reuse</h1>
<h4 class="author">Daniel Antal</h4>



<!--

subtitle: Version 0.1.6 https:://doi.org/10.5281/zenodo.6969653
output: pdf_document
-->
<p>The aim of the ‘dataset’ package is to make tidy datasets easier to
release, exchange and reuse. It organizes and formats data frame ‘R’
objects into well-referenced, well-described, interoperable datasets
into release and reuse ready form. It applies a subjective, R-language
compatible interpretation of the W3C <a href="https://www.w3.org/TR/vocab-data-cube/">Data Cube Vocabulary</a>
based on the statistical SDMX data cube model<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. We enrich these
statistical data exchange definition with similar definitions from
information science and the exchange of scientific resources on open
science repositories by applying the <a href="https://www.dublincore.org/specifications/dublin-core/dcmi-terms/">Dublin
Core</a> and <a href="https://support.datacite.org/docs/datacite-metadata-schema-44/">DataCite</a>
metadata specifications for R attributes to improve the findability,
accessibility, interoperability and reusability of the datasets.</p>
<p>We organize and format standard tabular data R objects (data.fame,
data.table, tibble, or even well-structured lists like json and json-ld)
become highly interoperable and can be placed into relational databases,
semantic web applications, archives, repositories. This puts the <a href="https://www.go-fair.org/fair-principles/">FAIR</a> principles into
the practice of an R environment workflow: they make these tabular data
objects more findable, more accessible, interoperable and reusable.</p>
<div id="statement-of-need" class="section level2">
<h2>Statement of need</h2>
<p>Open science repositories and analyst computers are full with
datasets that have no provenance, structural or referential data. We
believe that whenever possible, metadata should be machine-recorded when
possible, and should not be detached from an R object.</p>
<p>There are several R packages that have overalapping goals or
functionality to <code>dataset</code>, but they use a different
philosophy. When exporting to different files, they should be written as
exported, but no sooner, and preferably into the file that contains the
data.</p>
<p>The <a href="https://CRAN.R-project.org/package=dataspice">dataspice
package</a> aims to create well-defined and referenced datasets, but
follows a different schema and a different publication strategy. The
dataset package follows the more restrictive W3C/SDMX “DataSet”
definition within the datacube model, which is better suited to
synchronize with statistical data sources. Unlike dataset, it uses a
manual metadata entry from CSV files. (See the documentation of the <a href="https://docs.ropensci.org/dataspice/">dataspice</a> package.)</p>
<p>The <code>dataset</code> package aims for a higher level of
reproducibility, and does not detach the metadata from the R object’s
attributes (it is aimed to be used in other reproducible research
pacakges that will directly record provenance and other transactional
metadata into the attributes.) We aim to bind together
<code>dataspice</code> and <code>dataset</code> by creating export
functions to csv files that contain the same metadata that dataspice
records. Generally, dataspice seems to be better suited to raw,
observational data, while dataset for statistically processed data.</p>
<p>The intended use of <code>dataset</code> is to start correctly record
referential, structural and provenance metadata retrieved by various
reproducible science packages that interact with statistical data (such
as the rOpenGov packages <a href="https://CRAN.R-project.org/package=eurostat">eurostat</a> and <a href="https://CRAN.R-project.org/package=iotables">iotables</a>, or the
<a href="https://CRAN.R-project.org/package=OECD">OECD</a> package.</p>
<p>Neither <code>dataset</code> or <code>dataspice</code> are very
suitable of or documenting social sciences survey data, which are
usually held in datasets. Our aim is to connect <code>dataset</code>, <a href="https://CRAN.R-project.org/package=declared">declared</a> and <a href="https://CRAN.R-project.org/package=DDIwR">DDIwR</a> to create such
datasets with DDI codebook metadata. They will create a stable new
foundation of the <a href="https://CRAN.R-project.org/package=retroharmonize">retroharmonize</a>
package to create new, well-documented and harmonized statistical
datasets from the observational datasets of social sciences surveys.</p>
<p>The <a href="https://CRAN.R-project.org/package=zen4R">zen4R</a>
package provides reproducible export functionality to the zenodo open
science repository. Interacting with <code>zen4R</code> may be
intimidating for the casual R user as it uses R6 classes. Our aim to
provide an export function that completely wraps the workings of
<code>zen4R</code> when releasing the dataset.</p>
<p>In our experience, while the tidy data standards make reuse more
efficient by eliminating unnecessary data processing steps before
analysis or placement in a relational database, the application of
DataSet definition and the datacube model with the information science
metadata standards make reuse more efficient with exchanging and
combining the data with other data in different datasets.</p>
<p>Another use case we are having in mind is the releasing of the data
on a knowledge graph, or in an API that uses a well-defined schema. This
is the primary motivation for choosing the datacube model, because it is
used by most statistical APIs. The datacube model allows easy “slicing”,
or dimension reduction, that allows itself to an easy modelling into
RDF(S). (See later, and see a more comprehensive <a href="https://dataset.dataobservatory.eu/articles/RDF.html">From dataset
To RDF</a> vignette, which in turn heavily borrows from <a href="https://cran.r-project.org/package=rdflib/vignettes/rdf_intro.html">A
tidyverse lover’s intro to RDF</a> by Carl Boettiger.)</p>
</div>
<div id="development-dilemma" class="section level2">
<h2>Development dilemma</h2>
<ol style="list-style-type: decimal">
<li><p>The current development dilemma of <code>dataset</code> if it
should develop the <code>dataset()</code> into an s3 class, and if so,
should it be inherited from data.frame or tibble, keeping in mind the
desire to work well with data.table objects, too.</p></li>
<li><p>If not, then the <code>dataset()</code> functions should be
clearly seen as helper functions to augment data.frame, tibble and
data.table objects for easier use in data publication, release,
placement in databases and on knowledge graphs.</p></li>
</ol>
</div>
<div id="the-dataset-constructor" class="section level2">
<h2>The dataset constructor</h2>
<p>In the first step, we organize tidy datasets according to the data
cube model originally developed by the SDMX for exchanging statistical
data, by clearly stating which columns are to be used for grouping,
filtering and for calculations. In this step, we clearly state which
tidy columns are to be used as “measurements”, “dimensions” and
“attributes” of the dataset. This step will greatly simplify how we
obtain tidy subsets from a dataset, or how we reduce the dimensions of a
dataset to a triad or a quad to be placed on a knowledge graph.</p>
<p>In the second step, we add metadata is attributes to the R object
(regardless if it is a data.frame or an inherited tibble/data.table
object) which make the finding, understanding and the exchange of data
(including refreshing data from source), its placement in a database or
on a knowledge graph easier. This step will make the dataset easier to
understand both for human analysis and for computers, and greatly
increase their reuse potential, or the ability to review and replicate
them in reproducible research.</p>
<p>A mapping of R objects into these models has numerous advantages: it
makes data importing easier and less error-prone; it leaves plenty of
room for documentation automation; and it makes the publication of
results from R following the FAIR principles much easier.</p>
</div>
<div id="data-semantics" class="section level2">
<h2>Data semantics</h2>
<p>The tidy data principles are seemingly very simple: each variable is
a column, each observation is a row, and place all new units of
measurement into a new table. However, the steps of tidying up a messy
dataset require practice, like solving a Rubik cube––take a long time to
do quicky.</p>
<p>The tidy data principles frame Codd’s relational algebra,
particularly the third normal form (3NF), into statistical language and
make the storage and reuse of data in relational databases optional. It
suggests a format for tabular data and data semantics that makes a very
important and usually the most time-consuming (resource-consuming) part
of data analysis far more efficient because the analyst does not have to
reinvent the wheel all the time. The data cube model can be seen as an
extension of the tidy model that makes the storage, reuse, and exchange
of data among different database or their placement on a knowledge graph
optimal.</p>
<p>The wording of the tidy data principles is not sufficiently exact for
the data cube model. The 3NF form stipulates that the (e.g. table
columns) are functionally dependent solely on the primary key, which
means that we must have a primary key that is locally unique in the
table. If it exists, the primary key must be a unique combination of the
dimension and attribute columns, including the row identifier (rowid).
This means a lot more than the uniqueness of the measurement unit.</p>
<p>A usual dimension is the reference time period and the reference
geographical area. Consider a dataset that contains population growth
numbers from a county of a country, collected in the time period of
2010..2015 quarterly and in 2016:2020 annually, with the county borders
changing in 2014, and the unit of measure changed from the number of
people in thousands to the number of people in millions. The
measurements of the reference time period and the aggregation area has
changed, too.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(dataset)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>my_dataset <span class="ot">&lt;-</span> <span class="fu">dataset</span> (<span class="at">x =</span> <span class="fu">data.frame</span> (</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2019</span><span class="sc">:</span><span class="dv">2022</span>),<span class="dv">4</span>),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="at">geo =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;NL&quot;</span>,<span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;BE&quot;</span>,<span class="dv">8</span>)),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;F&quot;</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;M&quot;</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;F&quot;</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;M&quot;</span>, <span class="dv">4</span>)),</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>, <span class="cn">NA_real_</span>, <span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>, <span class="cn">NA_real_</span>, <span class="dv">2</span>,<span class="dv">5</span>),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">unit =</span> <span class="fu">rep</span>(<span class="st">&quot;NR&quot;</span>,<span class="dv">8</span>),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">freq =</span> <span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>,<span class="dv">8</span>)),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Example dataset&quot;</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">author =</span> <span class="fu">person</span>(<span class="st">&quot;Jane&quot;</span>, <span class="st">&quot;Doe&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>my_dataset</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; Doe J (2024). &quot;Example dataset.&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt;    time geo sex value unit freq</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; 1  2019  NL   F     1   NR    A</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; 2  2020  NL   F     3   NR    A</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt; 3  2021  NL   F     2   NR    A</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; 4  2022  NL   F     4   NR    A</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="co">#&gt; 5  2019  NL   M     2   NR    A</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="co">#&gt; 6  2020  NL   M     3   NR    A</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="co">#&gt; 7  2021  NL   M     1   NR    A</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="co">#&gt; 8  2022  NL   M     5   NR    A</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="co">#&gt; 9  2019  BE   F    NA   NR    A</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="co">#&gt; 10 2020  BE   F     4   NR    A</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="co">#&gt; 11 2021  BE   F     3   NR    A</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="co">#&gt; 12 2022  BE   F     2   NR    A</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="co">#&gt; 13 2019  BE   M     1   NR    A</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="co">#&gt; 14 2020  BE   M    NA   NR    A</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="co">#&gt; 15 2021  BE   M     2   NR    A</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="co">#&gt; 16 2022  BE   M     5   NR    A</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="co">#&gt; Further metadata: describe(x)</span></span></code></pre></div>
<div id="the-data-cube-model" class="section level3">
<h3>The data cube model</h3>
<p>The tidy data is designed to be easily handled in relational
databases and it is an ideal format for analysis in a closed system –
for example, when all your data for the analysis is stored in a
well-designed relational database. This semantics is, however,
insufficient for exchanging data with several data sources. This problem
has been attracting solutions for a long time by statistical agencies
and designers of hyperlinked, web-based products.</p>
<p>The dataset package is inspired by how statisticians have been
organizing data for publications for a long time: the data cube model.
The data cube model has additional, non-normative prescriptions for the
structure of the (tidy) dataset: columns must be grouped into
measurements, dimensions, and attributes. The dimensions are
non-measured variables, such as reference geographical areas and
reference time periods, that are usually used to filter out subsets
(slices) from a datacube. Attributes provide information about the
measurements, such as the unit of information and estimation method, and
usually can be seen as metadata for modelling purposes: they contain
observations (measurements) level metadata that is also often used for
filtering (selecting actual, imputed or missing cases, for example.)
Measurements are, in fact, the observations that we want to analyse.</p>
<p>The data cube model has long been the preferred format to organize
data for analytical use by SDMX. Statistical agencies exchange with each
other and publish data in datasets that conform to the data cube model.
Organizing your R tabular data like statisticians makes your work easier
to synchronize with statistical data sources: you can download or
exchange data in this format. Following the data cube model helps you to
understand the data more easily and bring your data to be analysed to a
tidy form in one or two steps — usually using attributes for subsetting,
dimensions for grouping, and measurements to carry out arithmetic
calculations like computing the group average values.</p>
</div>
</div>
<div id="interoperability" class="section level2">
<h2>Interoperability</h2>
<p>While tidying aims and preventing reinventing the wheel and many
times repeating the work of bringing the data from data storage, such as
a database, into a form that an analyst can work with, reproducible
research has further aims that add to the quality and inefficiency of
the analysis: it aims to make the tidy datasets and the research output
easier to reuse and to review and replicate for quality control and peer
review.</p>
<p>Data scientists know that however simple the tidy data rules are, it
takes a long time to get a feeling to easily put any messy, stored data
into a tidy format. Putting the data into a format that is easy to
review and offers an easy replication is even harder. As the famous
article by Monya Baker, <a href="https://www.nature.com/articles/doi:10.1038/533452a.epdf">1,500
scientists lift the lid on reproducibility</a> shows, the vast majority
of scientists have experienced the problem that seemingly replicable,
published scientific data cannot be replicated. More worryingly, the
majority of them expressed doubt about their ability to replicate their
very own findings. Datasets that are not easily replicated are also not
easily used as building blocks for further joined, more composite
data.</p>
<p>The lack of interoperability is often connected to the barrier of
understanding a dataset. Having a simple term in the column heading and
knowing that observations are in rows and variables are in columns is
not always sufficient to help to understand the meaning of the dataset.
The data cube model, which explicitly states dimension attributes for
the measurements, greatly increases the understandability.</p>
<blockquote>
<p>“Data is only potential information, raw and unprocessed, prior to
anyone actually being informed by it.” —Jeffrey Pomerantz, Metadata</p>
</blockquote>
<p>Understanding data (stored in a tabular or other format) requires
metadata, information by which the data can be represented in a simpler
form. The simplest and most useful metadata for this purpose is a title
or a label in the RDF model, a single, human-readable sentence that
describes the data.</p>
<p>The data cube model describes attributes, which can be seen as
metadata about observations, to be placed into the tabular format, and
dataset-level metadata, such as the title. What is missing from a tidy
dataset in a <code>data.frame</code>, <code>tibble</code> or
<code>data.table</code> format is the metadata.</p>
</div>
<div id="attributes" class="section level2">
<h2>Attributes</h2>
<p>In R, attributes of an object are designed to record metadata about
the object – if it is tabular data, then about the dataset itself. For a
tidy dataset, at least the names of the columns, the names of the rows,
and the names of the objects in memory are recorded. R places very few
restrictions on how to add metadata in the attribute fields of an object
or place new fields – you can add far more metadata than the size of the
actual data frame if you like.</p>
<p>The dataset package defines a pseudo-class that enriches data frames
with standardized metadata used in the RDF and SDMX datacube model, and
the Dublin Core and DataCite metadata standards of libraries that make
datasets easier to find, attribute and more interoperable and reuseable
by providing more information about their contents.</p>
<p>The dataset class (see: <code>dataset()</code>)is a pseudo-class.
Although it is defined as a class inherited from the base R data.frame
S3 class, in fact, it does not alter the way you interact with the data,
and for analytical purposes the object remains a data.frame. It is also
a pseudo-class because the functions built in the dataset constructor
work exactly as well on tibbles or data.table objects, because they only
touch metadata attributes of the R object.</p>
<p>The <code>dublincore()</code> function and its helper functions add
metadata as attributes to any R object. The Dublin Core Elements were
originally library standards that facilitate finding resources (files)
in libraries. The RDF datacube definition, which aims to enable machines
to connect datasets automatically, refers to a part of the Dublin Core
definition —however, it is a good practice to add all Dublin Core
elements to a dataset.</p>
<p>The <code>datacite()</code> functions and its helper functions add
mandatory and optional metadata from the DataCite standard, which is
often preferred by open science data repositories aimed to a public
storage of datasets. The DataCite standard is newer than Dublin Core,
and was specifically designed to facilitate finding, accessing, and
reusing data. It greatly overlaps with Dublin Core but contains further
information that is particularly useful for datasets (for example,
estimated dataset object size in memory or data storage.)</p>
<p>Both the Dublin Core Metadata Elements definition 1.1 and DataCite
Metadata Scheme 4.4 refer to standard information elements properties,
for example, the ISO standard of describing the size of an object in
computers or the ISO standard of describing reference time or reference
geographical areas for the data collection. Some of the helper functions
of <code>dublincore_add()</code> and <code>datacite_add()</code> already
validate the correct formatting of this information; some will be added
in later versions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>iris_datacite  <span class="ot">&lt;-</span> <span class="fu">datacite</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">Title =</span> <span class="st">&quot;Iris Dataset&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">Creator =</span> <span class="fu">person</span>(<span class="st">&quot;Anderson&quot;</span>, <span class="st">&quot;Edgar&quot;</span>, <span class="at">role =</span> <span class="st">&quot;aut&quot;</span>),</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">Publisher =</span> <span class="st">&quot;American Iris Society&quot;</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">Identifier =</span> <span class="st">&quot;https://doi.org/10.1111/j.1469-1809.1936.tb02137.x&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">PublicationYear =</span> <span class="dv">1935</span>,</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">Description =</span> <span class="st">&quot;This famous (Fisher&#39;s or Anderson&#39;s) iris data set gives the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris. The species are Iris setosa, versicolor, and virginica.&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">Language =</span> <span class="st">&quot;en&quot;</span>)</span></code></pre></div>
<p>In R, objects can have arbitrary attributes. For example, a
data.frame has a class attribute that tells functions to treat the
object as a data.frame.Under the hood, you still keep your data frame
object of choice, the good old base r ?data.frame, or the more modern
data.table or tibble.</p>
<p>We add descriptive metadata conforming the Dublin Core and <a href="https://schema.datacite.org/">DataCite standard</a> as data frame
attributes because they must clearly describe the dataset. The
dataset-level attributes do not interfere with the tidy data concept
because the tidy data concept relates to the contents of the data
frame.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">print</span>(iris_datacite, <span class="st">&quot;Bibtex&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; @Misc{,</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;   title = {Iris Dataset},</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt;   author = {Anderson Edgar},</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;   identifier = {https://doi.org/10.1111/j.1469-1809.1936.tb02137.x},</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;   publisher = {American Iris Society},</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;   year = {1935},</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;   date = {:tba},</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;   language = {en},</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;   alternateidentifier = {:unas},</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;   relatedidentifier = {:unas},</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;   format = {:tba},</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;   rights = {:tba},</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;   description = {This famous (Fisher&#39;s or Anderson&#39;s) iris data set gives the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris. The species are Iris setosa, versicolor, and virginica.},</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt;   geolocation = {:unas},</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt;   fundingreference = {:unas},</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; }</span></span></code></pre></div>
</div>
<div id="linked-data-from-dataset-to-rdf" class="section level2">
<h2>Linked Data: From dataset To RDF</h2>
<p>The assumption of third normal form (3NF), or a more precise form of
tidiness, is that each observation has a primary key locally, i.e. in
the dataset, is insufficient. For updating a dataset, i.e. joining new
observations or new columns, we need to work with globally universal
observation identifiers, or URIs. (Otherwise, we must map the various
locally unique keys to each other, i.e. we need to know various database
schemas.) The idea of linked data, or RDF, is to reduce the data to a
triple, and move all metadata, including referential or structural
metadata into this triple.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>my_dataset_uri <span class="ot">&lt;-</span> <span class="fu">dataset_uri</span>(my_dataset, </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                              <span class="at">prefix =</span> <span class="st">&quot;https:://example.org/my_iris&quot;</span>, </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                              <span class="at">keep_local_id =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>my_dataset_uri</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>nq_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;triple_file.nq&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>my_triple <span class="ot">&lt;-</span> <span class="fu">subset</span>(my_dataset_uri, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;URI&quot;</span>, <span class="st">&quot;value&quot;</span>, <span class="st">&quot;unit&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(rdflib)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>rdf <span class="ot">&lt;-</span> <span class="fu">rdf</span>()</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(my_triple))) {</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">rdf_add</span>(<span class="at">rdf =</span> rdf, </span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>          <span class="at">subject =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>          <span class="at">predicate =</span> my_triple<span class="sc">$</span>URI[i], </span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>          <span class="at">object =</span> my_triple<span class="sc">$</span>value[i])</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>}</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">rdf_serialize</span>(rdf, <span class="at">doc =</span> nq_file)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">rdf_parse</span>(nq_file) </span></code></pre></div>
<p>For a more comprehensive <a href="https://dataset.dataobservatory.eu/articles/RDF.html">From dataset
To RDF</a>, which in turn heavily borrows from <a href="https://cran.r-project.org/package=rdflib/vignettes/rdf_intro.html">A
tidyverse lover’s intro to RDF</a> by Carl Boettiger.</p>
</div>
<div id="planned-functionality" class="section level2">
<h2>Planned functionality</h2>
<p>The dataset package is aiming to make tidy datasets easier to
release, exchange and reuse. The motivation of the ecosystem of the <a href="https://dataset.dataobservatory.eu/">dataset</a>, <a href="https://statcodelists.dataobservatory.eu/">statcodelists</a>, and
the dataobservatory packages is to provide a comprehensive toolkit that
helps many reproducible research tasks.</p>
<p>The <code>dataset</code> package already has an offspring, the
<code>surveydataset</code> package, which is aimed to connect the
dataset functionality with some elements of DDI, a metadata standard to
work with social sciences survey data, and to connect the dataset
package with the <a href="https://CRAN.R-project.org/package=retroharmonize/">retroharmonize</a>
package that harmonizes data from different surveys.</p>
<p>Our real goal is to facilitate efficient reproducible research
workflows that perform flawlessly tasks that most R users, even
scientific researchers, are unfamiliar with—or if they are familiar with
them, they find it boring because they will usually not get credited for
it as analysts or researchers.</p>
<p>Our <a href="https://dataset.dataobservatory.eu/reference/dataset.html">datasets</a>:</p>
<ul class="task-list">
<li><input type="checkbox" checked></input>contain Dublin Core or DataCite
(or both) metadata that makes the findable and easier accessible via
online libraries</li>
<li><input type="checkbox" checked></input>are easily reduced to linked
open data formats to be serialized to or synchronized with semantic web
applications</li>
<li><input type="checkbox" checked></input>follow the datacube model of the
Statistical Data and Metadata eXchange, therefore allowing easy
refreshing with new data from the source of the analytical work</li>
<li><input type="checkbox" checked></input>contain processing metadata that
greatly enhance the reproducibility of the results, and the
reviewability of the contents of the dataset, including metadata defined
by the [DDI]</li>
<li><input type="checkbox" checked></input>relatively lightweight in
dependencies and easily works with data.frame, tibble or data.table R
objects.</li>
</ul>
<p>The W3C consortium uses the datacube model for describing datasets or
tabular data resources that can be easily connected via the internet
infrastructure. RDF, Because the SDMX standards pre-date the definition
of RDF, it took a long time to sufficiently harmonize RDF and SDMX to
become a standard for statistical data that can be easily exchanged by
humans and computers alike, therefore making it ideal for reproducible
research.</p>
<p>We also aim to replace the <code>survey</code> in the <a href="https://retroharmonize.dataobservatory.eu/">retroharmonize</a>
survey harmonization package to an inherited dataset that is optimized
to contain social sciences survey data.</p>
<p>The connecting <a href="https://statcodelists.dataobservatory.eu/">statcodelists</a>
packages facilitate further reproducibility with standardized, natural
language-independent codelists for categorical variables. Such
categorical variables are correctly interpreted in a wide array of
statistical applications and can be easily joined with data from many
countries, irrespective of the primary sources’ language.</p>
<p>See: <a href="https://csarven.ca/linked-sdmx-data">Linked SDMX
Data</a></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Baker, Monya. 2016. “1,500 Scientists Lift the Lid on
reproducibility.” <em>Nature</em> 533 (7604): 452–54. <a href="https://www.nature.com/articles/533452a.epdf" class="uri">https://www.nature.com/articles/533452a.epdf</a>.</p>
<p>Capadisli, Sarven, Sören Auer, and Axel-Cyrille Ngonga Ngomo. 2015.
“Linked SDMX Data: Path to High Fidelity Statistical Linked Data.”
<em>Semantic Web</em> 6 (2): 105–12. <a href="https://doi.org/10.3233/SW-130123" class="uri">https://doi.org/10.3233/SW-130123</a>.</p>
<p>Core, Dublin. 2020. “DCMI Metadata Terms.” <a href="http://dublincore.org/specifications/dublin-core/dcmi-terms/2020-01-20/" class="uri">http://dublincore.org/specifications/dublin-core/dcmi-terms/2020-01-20/</a>.</p>
<p>Group, DataCite Metadata Working. 2021. “DataCite Metadata Schema
Documentation for the Publication and Citation of Research Data and
Other Research Outputs. Version 4.4.” DataCite e.V. <a href="https://doi.org/10.14454/3w3z-sa82" class="uri">https://doi.org/10.14454/3w3z-sa82</a>.</p>
<p>Pomerantz, Jeffrey. 2015. <em>Metadata</em>. The MIT Press Essential
Knowledge Series. Cambridge, MA, USA: MIT Press.</p>
<p>Wickham, Hadley. 2014. “Tidy Data.” <em>Journal of Statistical
Software</em> 59 (10): 1–23. <a href="https://doi.org/10.18637/jss.v059.i10" class="uri">https://doi.org/10.18637/jss.v059.i10</a>.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>RDF Data Cube Vocabulary, W3C Recommendation 16 January
2014 <a href="https://www.w3.org/TR/vocab-data-cube/" class="uri">https://www.w3.org/TR/vocab-data-cube/</a>, Introduction to
SDMX data modelling <a href="https://www.unescap.org/sites/default/files/Session_4_SDMX_Data_Modeling_%20Intro_UNSD_WS_National_SDG_10-13Sep2019.pdf" class="uri">https://www.unescap.org/sites/default/files/Session_4_SDMX_Data_Modeling_%20Intro_UNSD_WS_National_SDG_10-13Sep2019.pdf</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
